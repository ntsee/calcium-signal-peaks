# Calcium Signal Peaks
A tool used to smooth the signal and identify peaks in a calcium signal dataset.

This script takes in a CSV file generated by the Calcium Signal ImageJ plugin. This dataset contains information on the signal strength of multiple calcium cells over time. Noise is removed from the signal using wavelet denoise. Minimas and maximas are identified based off of the change in sign of slope. The minimas and maximas are pruned if the distance between peaks are less than a normalized threshold (k). Normalization is applied to both the X and Y axis. 

## Requirements
* Python 3.10+
* PIP3 Libraries
  * matplotlib 
  * numpy 
  * pandas
  * scipy
  * scikit-image
  
## Installation
* Download Python 3 from the [official website](https://www.python.org/downloads/)
* Install required libraries using the command `pip install -r requirements.txt`

## Running the Script
This program is preconfigured to work with an example dataset included in the repository. Some useful parameters can be easily configured in the main method of the script including:
* `input_file` the path to the csv dataset containing calcium signal strength over time
* `k_values` an array of thresholds that are applied to each cell. An additional graph and table is generated for each value. k is a percentage and should be in the range of 0.0 to 1.0
* `output_pdf_file` an optional parameter that will pack all of the graphs generated for each cell into a single PDF file. This should be the name of the PDF file, otherwise ommit it to avoid packing the images into a PDF
* `keep_image_files` an optional bool parameter that will delete the png files generated for each cell. 

## Example

<img src="https://user-images.githubusercontent.com/29243779/219811331-9f5625f8-8eb7-476c-9b22-793b42acb8bc.png" width=75%>


